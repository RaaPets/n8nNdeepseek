# ###########################
# MESSAGE: 1
###### id: 188a13cbdec2327a
–õ—é–±–ª—é –º—É–∑—ã–∫—É –≤ —Å—Ç–∏–ª—è—Ö —Ç—è–∂–µ–ª—ã–π –º–µ—Ç–∞–ª–ª –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞. –¢–∞–∫ –∂–µ —É–º–µ—é—Ç –∏–≥—Ä–∞—Ç—å –Ω–µ–º–Ω–æ–≥–æ –Ω–∞ –≥–∏—Ç–∞—Ä–µ –∏ —Å–∏–Ω—Ç–µ–∑–∞—Ç–æ—Ä–µ. –î–ª—è –≥–∏—Ç–∞—Ä—ã —Ä–µ–≥—É–ª—è—Ä–Ω–æ –¥–µ–ª–∞—é —Å–≤–æ—é —Ä–∞—Å–ø–∞–π–∫—É –∑–≤—É–∫–æ—Å–Ω–∏–º–∞—Ç–µ–ª–µ–π.
–î–ª—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –æ—Ä–∏–≥–Ω–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–∫–æ–≤ –∏–Ω–æ–≥–¥–∞ –ø—Ä–æ–±—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–≤—É–∫–æ–≤–æ–π-–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä. –ù–æ –æ–Ω –∏–º–µ–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É, —Ç.–∫. —ç—Ç–æ –æ–±—ã—á–Ω–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ–≥–∞-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–µ–≤–∞–π—Å. –ü–æ—ç—Ç–æ–º—É —Å—Ç–∞–ª –∑–∞–¥—É–º—ã–≤–∞—Ç—å—Å—è —Å–ø–∞—è—Ç—å –Ω–∞ –∫–∞–∫–æ–º-–Ω–∏–±—É–¥—å –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–º –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä –µ—Å—Ç—å –æ–ø—ã—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞—Å–ø–∞–π–∫–∏ –Ω–∞ –±–∞–∑–µ Atmel) –∫–∞–∫–æ–π-—Ç–æ –±–æ–ª–µ–µ —É–∑–∫–æ—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –ø—Ä—è–º–æ –Ω–∞ –≥–∏—Ç–∞—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏–∫–∏ —Å–∏–≥–Ω–∞–ª–∞ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ç–µ–ª—å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ —á–µ—Ä–µ–∑ –∑–≤—É–∫–æ—Å–Ω–∏–º–∞—Ç–µ–ª–∏ –∏ —Ç–¥).
–ï—Å—Ç—å –∫–∞–∫–∏–µ-—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –∏–¥–µ–∏? –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏?



# ###########################
# MESSAGE: 2
###### id: 188a13d665ad11dc
–û—Ç–ª–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥ ‚Äî —Å–æ–≤–º–µ—â–µ–Ω–∏–µ –º—É–∑—ã–∫–∞–ª—å–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏ —Å –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–π –º—ã—Å–ª—å—é. –í–∞—à –æ–ø—ã—Ç —Å Atmel –∏ –ø–∞–π–∫–æ–π ‚Äî —Ö–æ—Ä–æ—à–∞—è –±–∞–∑–∞. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∏–¥–µ–∏ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã.

### üîß –ö–æ–Ω—Ü–µ–ø—Ü–∏–∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –Ω–∞ –≥–∏—Ç–∞—Ä–µ

| –ò–¥–µ—è —ç—Ñ—Ñ–µ–∫—Ç–∞ | –°—É—Ç—å | –°–ª–æ–∂–Ω–æ—Å—Ç—å | Atmel-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π –ú–ö |
| :--- | :--- | :--- | :--- |
| **–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä/–õ–∏–º–∏—Ç–µ—Ä** | –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–∏–Ω–∞–º–∏–∫–∏, ¬´—Å—É—Å—Ç–µ–π–Ω¬ª. –ö–ª–∞—Å—Å–∏–∫–∞ –¥–ª—è —Å–æ–ª–æ. | –°—Ä–µ–¥–Ω—è—è (–Ω—É–∂–Ω—ã –±—ã—Å—Ç—Ä—ã–µ –ê–¶–ü/–¶–ê–ü) | ATmega32U4 (–µ—Å—Ç—å USB), ATSAMD21 |
| **–ê–Ω–∞–ª–æ–≥–æ–≤–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ** | –õ–µ–≥–∫–æ–µ ¬´–ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω–æ–µ¬ª –∑–≤—É—á–∞–Ω–∏–µ –ª–∞–º–ø–æ–≤–æ–≥–æ –ø—Ä–µ–∞–º–ø–∞. | –í—ã—Å–æ–∫–∞—è (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏) | –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ; —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ Cortex-M4/M7 (ATSAM4, STM32F4) |
| **–§–∞–∑–æ–≤—Ä–∞—â–∞—Ç–µ–ª—å/–§–ª–µ–Ω–¥–∂–µ—Ä** | –ú–æ–¥—É–ª—è—Ü–∏–æ–Ω–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–æ–Ω–∞. | –°—Ä–µ–¥–Ω—è—è | ATmega328p (—Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π) |
| **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏** | –£–ø—Ä–∞–≤–ª—è–µ–º–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å —á–µ—Ä–µ–∑ –∑–≤—É–∫–æ—Å–Ω–∏–º–∞—Ç–µ–ª–∏. | –°—Ä–µ–¥–Ω—è—è | –õ—é–±–æ–π —Å –±—ã—Å—Ç—Ä—ã–º –ê–¶–ü –∏ –®–ò–ú/–¶–ê–ü |
| **–ò—Å–∫–∞–∂–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ª–Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü** | –¶–∏—Ñ—Ä–æ–≤–æ–µ ¬´–≥—Ä—è–∑–Ω–æ–µ¬ª –∑–≤—É—á–∞–Ω–∏–µ —Å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä—É–µ–º—ã–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º. | –í—ã—Å–æ–∫–∞—è | –¢—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏; ATSAMD51 |

### üéõÔ∏è –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
1.  **–ó–∞–¥–µ—Ä–∂–∫–∞ (–ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å)**: –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å **<5 –º—Å** –¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–π –∏–≥—Ä—ã. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫:
    *–õ–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å = (–†–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ / –ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏) √ó 2 (–ê–¶–ü + –¶–ê–ü)*
2.  **–ê–¶–ü/–¶–ê–ü**: –ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –æ—Ç 40 –∫–ì—Ü, —Ä–∞–∑—Ä—è–¥–Ω–æ—Å—Ç—å 12-16 –±–∏—Ç.
3.  **–ü–∏—Ç–∞–Ω–∏–µ**: 9–í (–≥–∏—Ç–∞—Ä–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç) ‚Üí —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä –Ω–∞ 3.3–í/5–í –¥–ª—è –ú–ö.
4.  **–†–∞–∑–º–µ—â–µ–Ω–∏–µ**: –ö–æ—Ä–ø—É—Å –≤ –ø–æ–ª–æ—Å—Ç–∏ –≥–∏—Ç–∞—Ä—ã –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–π –ø–µ–¥–∞–ª—å-—Ñ–æ—Ä–º–∞—Ç.

### üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
–î–ª—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–µ–≥–æ –æ–ø—ã—Ç–∞ —Å Atmel:

**–í–∞—Ä–∏–∞–Ω—Ç 1: ATmega32U4** (–Ω–∞–ø—Ä–∏–º–µ—Ä, Arduino Leonardo/Pro Micro)
*   **–ü–ª—é—Å—ã**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π USB –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏/–∑–∞–≥—Ä—É–∑–∫–∏, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ I/O.
*   **–ú–∏–Ω—É—Å—ã**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.
*   **–ò–¥–µ—è –¥–ª—è —Å—Ç–∞—Ä—Ç–∞**: **–¶–∏—Ñ—Ä–æ–≤–æ–π –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä**.
    *   –ê–ª–≥–æ—Ä–∏—Ç–º (—É–ø—Ä–æ—â–µ–Ω–Ω–æ):
        1.  –ê–¶–ü —Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–∏–≥–Ω–∞–ª.
        2.  –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è RMS-–∞–º–ø–ª–∏—Ç—É–¥–∞.
        3.  –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É—Å–∏–ª–µ–Ω–∏—è/–æ—Å–ª–∞–±–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –æ—Ç—Å—á—ë—Ç–∞–º.
        4.  –¶–ê–ü –≤—ã–≤–æ–¥–∏—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π —Å–∏–≥–Ω–∞–ª.

```cpp
// –ü—Å–µ–≤–¥–æ–∫–æ–¥ –¥–ª—è ATmega32U4
int16_t input = readADC();
float rms = calculateRMS(input); // —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ
float gain = computeGain(rms, threshold, ratio); // —Ñ—É–Ω–∫—Ü–∏—è –∫–æ–º–ø—Ä–µ—Å—Å–∏–∏
int16_t output = (int16_t)(input * gain);
writeDAC(output);
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: ATSAMD21/51** (Cortex-M0+/M4)
*   **–ü–ª—é—Å—ã**: –ì–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, 12-–±–∏—Ç–Ω—ã–π –ê–¶–ü, –¶–ê–ü (–Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö), DMA.
*   **–ú–∏–Ω—É—Å—ã**: –ß—É—Ç—å —Å–ª–æ–∂–Ω–µ–µ –≤ –æ—Å–≤–æ–µ–Ω–∏–∏.
*   **–ò–¥–µ—è**: **–§–∞–∑–æ–≤—Ä–∞—â–∞—Ç–µ–ª—å —Å LFO**.
    *   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DMA –ø–æ–∑–≤–æ–ª–∏—Ç —Å–Ω–∏–∑–∏—Ç—å –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å.

### üîå –°—Ö–µ–º–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω—é–∞–Ω—Å—ã
1.  **–í—Ö–æ–¥–Ω–æ–π –∫–∞—Å–∫–∞–¥**: –ë—É—Ñ–µ—Ä –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º —É—Å–∏–ª–∏—Ç–µ–ª–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, TL072) –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ–∏–º–ø–µ–¥–∞–Ω—Å–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ –∑–≤—É–∫–æ—Å–Ω–∏–º–∞—Ç–µ–ª—è —Å –ê–¶–ü –ú–ö.
2.  **–í—ã—Ö–æ–¥–Ω–æ–π –∫–∞—Å–∫–∞–¥**: –§–∏–ª—å—Ç—Ä –Ω–∏–∑–∫–∏—Ö —á–∞—Å—Ç–æ—Ç –ø–æ—Å–ª–µ –¶–ê–ü –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç—É–ø–µ–Ω—á–∞—Ç–æ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–∞.
3.  **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –≠–Ω–∫–æ–¥–µ—Ä—ã/–º–∏–Ω–∏-–ø–æ—Ç–µ–Ω—Ü–∏–æ–º–µ—Ç—Ä—ã –¥–ª—è —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞ –ª–µ—Ç—É.

### üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
*   **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏/–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã**: 
    *   **ARM**: Mbed, Arduino Core –¥–ª—è SAMD.
    *   **DSP**: –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ **KISS FFT** –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –∏–ª–∏ **CMSIS-DSP** –¥–ª—è ARM Cortex.
*   **–ê–ª–≥–æ—Ä–∏—Ç–º—ã**: –ö–Ω–∏–≥–∞ **¬´Designing Audio Effect Plugins in C++¬ª** Will Pirkle (–ø—Ä–∏–Ω—Ü–∏–ø—ã –ø–µ—Ä–µ–Ω–æ—Å–∏–º—ã –Ω–∞ –ú–ö).
*   **–°–æ–æ–±—â–µ—Å—Ç–≤–∞**: **DSP Forum**, **Electro-Music.com**, —Ä–∞–∑–¥–µ–ª—ã –ø–æ –≥–∏—Ç–∞—Ä–Ω–æ–π —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–µ.

**–° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å?**
–°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Å—Ç–æ–π **–ø–µ—Ç–ª—é —ç—Ñ—Ñ–µ–∫—Ç–∞** –Ω–∞ ATmega32U4: –ê–¶–ü ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–∑—ã) ‚Üí –¶–ê–ü. –ò–∑–º–µ—Ä—å—Ç–µ –∑–∞–¥–µ—Ä–∂–∫—É –æ—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ–æ–º. –≠—Ç–æ –¥–∞—Å—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.

–ö–∞–∫–æ–π –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –∫–∞–∂–µ—Ç—Å—è –≤–∞–º –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–∏–º–µ–Ω–∏–º—ã–º –¥–ª—è –≤–∞—à–µ–≥–æ —Å—Ç–∏–ª—è –∏–≥—Ä—ã?

# ###########################
# MESSAGE: 3
###### id: 188a13e1cb8dbebd
–û—Ç–ª–∏—á–Ω—ã–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑. –í—ã –∑–∞—Ç—Ä–æ–Ω—É–ª–∏ –∫–ª—é—á–µ–≤—ã–µ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã—Ö –≥–∏—Ç–∞—Ä–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤. –ü–æ–∑–≤–æ–ª—é —Å–µ–±–µ —É–≥–ª—É–±–∏—Ç—å—Å—è –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –≤–∞—à–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è—Ö.

### üéõÔ∏è –£–≥–ª—É–±–ª–µ–Ω–∏–µ –≤ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –æ–±—Ä–∞–±–æ—Ç–∫–∏
–í–∞—à–∞ —Ñ–æ—Ä–º—É–ª–∞ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –≤–µ—Ä–Ω–∞. –î–ª—è `–ë—É—Ñ–µ—Ä = 64 —Å—ç–º–ø–ª–∞, Fs = 40 –∫–ì—Ü`:
`(64 / 40000) * 2 = 3.2 –º—Å` ‚Äî —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –º–∏–Ω–∏–º—É–º.

**–û–¥–Ω–∞–∫–æ, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã:**
1.  **–í—Ä–µ–º—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ê–¶–ü/–¶–ê–ü**: –î–ª—è 12-–±–∏—Ç–Ω–æ–≥–æ –ê–¶–ü –≤ ATmega32U4 –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ (~15 ¬µs –Ω–∞ –æ—Ç—Å—á—ë—Ç) —ç—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç ~1 –º—Å –Ω–∞ –±—É—Ñ–µ—Ä.
2.  **–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞**: –ú–µ–∂–¥—É –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º –≤—Ö–æ–¥–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞ –∏ –Ω–∞—á–∞–ª–æ–º –æ–±—Ä–∞–±–æ—Ç–∫–∏.
3.  **DMA vs Polling/Interrupt**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **DMA** (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –ø–∞–º—è—Ç–∏), –∫–∞–∫ –≤ ATSAMD21, –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —è–¥—Ä–æ –∏ –∑–∞–¥–µ—Ä–∂–∫—É, —Ç–∞–∫ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –º–µ–∂–¥—É –ê–¶–ü/–¶–ê–ü –∏ –ø–∞–º—è—Ç—å—é –±–µ–∑ —É—á–∞—Å—Ç–∏—è CPU.

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥:** –î–ª—è ATmega –¥–æ—Å—Ç–∏—á—å —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö <5 –º—Å —Å–ª–æ–∂–Ω–æ. ATSAMD21/51 —Å DMA ‚Äî –±–æ–ª–µ–µ –Ω–∞–¥—ë–∂–Ω–∞—è –æ—Å–Ω–æ–≤–∞ –¥–ª—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞.

### ‚öôÔ∏è –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞ –¥–ª—è ATmega32U4
–í–∞—à –ø—Å–µ–≤–¥–æ–∫–æ–¥ –≤–µ—Ä–Ω–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É. –í–æ—Ç –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

**1. –†–∞—Å—á—ë—Ç –∞–º–ø–ª–∏—Ç—É–¥—ã (RMS vs Peak Detection)**
*   **–ü–∏–∫–æ–≤–æ–µ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –º–µ–Ω–µ–µ —Ä–µ—Å—É—Ä—Å–æ—ë–º–∫–æ –¥–ª—è –ú–ö –∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –≥–∏—Ç–∞—Ä–Ω—ã—Ö –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞—Ö –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∞—Ç–∞–∫–∏.
*   **–£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –¥–µ—Ç–µ–∫—Ç–æ—Ä –æ–≥–∏–±–∞—é—â–µ–π** (–¥–ª—è ATmega):
```cpp
// –ê—Ç–∞–∫–∞ –∏ —Ä–µ–ª–∏–∑ –∑–∞–¥–∞—é—Ç—Å—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏ –æ—Ç 0 –¥–æ 1
float attack_coeff = 0.1; // –ë—ã—Å—Ç—Ä–æ–µ –Ω–∞—Ä–∞—Å—Ç–∞–Ω–∏–µ
float release_coeff = 0.001; // –ú–µ–¥–ª–µ–Ω–Ω—ã–π —Å–ø–∞–¥

float envelope = 0.0;
int16_t sample_abs = abs(input_sample);

if (sample_abs > envelope) {
    envelope = attack_coeff * (sample_abs - envelope) + envelope;
} else {
    envelope = release_coeff * (sample_abs - envelope) + envelope;
}
```

**2. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —É—Å–∏–ª–µ–Ω–∏—è (Gain Computer)**
*   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** —Å –ø–æ—Ä–æ–≥–æ–º (threshold) –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ–º (ratio).
```cpp
float computeGain(float envelope, float threshold, float ratio) {
    if (envelope <= threshold) return 1.0; // –ù–∏–∂–µ –ø–æ—Ä–æ–≥–∞ ‚Äî —É—Å–∏–ª–µ–Ω–∏–µ 1
    // –í—ã—à–µ –ø–æ—Ä–æ–≥–∞: —É–º–µ–Ω—å—à–µ–Ω–∏–µ –ø–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–º—É –∑–∞–∫–æ–Ω—É
    float over_db = 20 * log10(envelope / threshold);
    float gain_reduction_db = over_db * (1 - 1/ratio);
    return pow(10, gain_reduction_db / 20);
}
```

### üî¨ –°—Ö–µ–º–æ—Ç–µ—Ö–Ω–∏–∫–∞ –≤—Ö–æ–¥–Ω–æ–≥–æ/–≤—ã—Ö–æ–¥–Ω–æ–≥–æ –∫–∞—Å–∫–∞–¥–∞: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω—é–∞–Ω—Å—ã

| –ö–∞—Å–∫–∞–¥ | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| :--- | :--- | :--- | :--- |
| **–í—Ö–æ–¥–Ω–æ–π** | Op-amp (TL072), R=1M, C=100p | –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∏–º–ø–µ–¥–∞–Ω—Å–∞, –ê–ß–• | –î–æ–±–∞–≤–∏—Ç—å –¥–∏–æ–¥—ã –®–æ—Ç—Ç–∫–∏ (BAT54) –Ω–∞ –≤—Ö–æ–¥–∞—Ö –¥–ª—è –∑–∞—â–∏—Ç—ã –ê–¶–ü –æ—Ç —Ä–∞–∑—Ä—è–¥–æ–≤. |
| **–ê–¶–ü-—Ñ–∏–ª—å—Ç—Ä** | RC-—Ñ–∏–ª—å—Ç—Ä (R=100, C=10n) | –ê–Ω—Ç–∏-–∞–ª–∏–∞—Å–∏–Ω–≥ | –ß–∞—Å—Ç–æ—Ç–∞ —Å—Ä–µ–∑–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å < Fs/2. –î–ª—è 40 –∫–ì—Ü ‚Äî ~20 –∫–ì—Ü. |
| **–¶–ê–ü-—Ñ–∏–ª—å—Ç—Ä** | –ê–∫—Ç–∏–≤–Ω—ã–π –§–ù–ß 2-–≥–æ –ø–æ—Ä—è–¥–∫–∞ (Sallen-Key) | –°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ (—Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è) | Op-amp (TL072), —á–∞—Å—Ç–æ—Ç–∞ —Å—Ä–µ–∑–∞ ~16-20 –∫–ì—Ü. |
| **–í—ã—Ö–æ–¥–Ω–æ–π –±—É—Ñ–µ—Ä** | Op-amp, R=10k | –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ —Å –Ω–∏–∑–∫–∏–º Z | –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –Ω–∞ –¥–ª–∏–Ω–Ω—ã–π –∫–∞–±–µ–ª—å. |

### üß† –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ 32-–±–∏—Ç–Ω—ã–µ —è–¥—Ä–∞ (ATSAMD21/Cortex-M0+)
–î–ª—è —Ñ–∞–∑–æ–≤—Ä–∞—â–∞—Ç–µ–ª—è –∏–ª–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —ç—Ç–æ –ª–æ–≥–∏—á–Ω—ã–π —à–∞–≥.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
*   **–¢–∞–∫—Ç–æ–≤–∞—è —á–∞—Å—Ç–æ—Ç–∞** 48 –ú–ì—Ü vs 16 –ú–ì—Ü —É ATmega.
*   **–ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —É–º–Ω–æ–∂–∏—Ç–µ–ª–∏** –∏ **DMA**.
*   **12-–±–∏—Ç–Ω—ã–π –ê–¶–ü** —Å —á–∞—Å—Ç–æ—Ç–æ–π –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –¥–æ 350 ksps.
*   **–ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ USB** (–¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å –ü–ö).

**–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å DMA –Ω–∞ ATSAMD21:**
1.  –ê–¶–ü –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ —á–µ—Ä–µ–∑ DMA.
2.  –ü–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é –ø–æ–ª–æ–≤–∏–Ω—ã –±—É—Ñ–µ—Ä–∞ (–ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –ø–æ –ø–æ–ª—É–ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—é) CPU –Ω–∞—á–∏–Ω–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä–≤–æ–π –ø–æ–ª–æ–≤–∏–Ω—ã, –ø–æ–∫–∞ DMA –∑–∞–ø–æ–ª–Ω—è–µ—Ç –≤—Ç–æ—Ä—É—é (**–¥–≤–æ–π–Ω–∞—è –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è**).
3.  –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –¶–ê–ü —á–µ—Ä–µ–∑ –≤—Ç–æ—Ä–æ–π –∫–∞–Ω–∞–ª DMA.

**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–ê—Äduino Core –¥–ª—è SAMD** –∏–ª–∏ **ASF (Advanced Software Framework)** –æ—Ç Microchip –¥–ª—è –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ DMA.

### ‚ùì –í–æ–ø—Ä–æ—Å –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
–£—á–∏—Ç—ã–≤–∞—è –≤–∞—à –æ–ø—ã—Ç —Å –ø–∞–π–∫–æ–π –∏ Atmel, –∫–∞–∫–æ–π –∞—Å–ø–µ–∫—Ç –∫–∞–∂–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
1.  **–°—Ö–µ–º–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å** (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π, —à—É–º—ã, –ø–∏—Ç–∞–Ω–∏–µ)?
2.  **–ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è** –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å –∂—ë—Å—Ç–∫–∏–º–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏?
3.  **–û—Ç–ª–∞–¥–∫–∞ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–µ** –∏—Ç–æ–≥–æ–≤—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ (–ê–ß–•, THD, –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å)?

–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ—Ç–≤–µ—Ç–∞, –º–æ–∂–Ω–æ —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —à–∞–≥–∞—Ö –ø–æ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏—é —ç—Ç–∏—Ö —Å–ª–æ–∂–Ω–æ—Å—Ç–µ–π.

# ###########################
# MESSAGE: 4
###### id: 188a13eee8cddcb7
–û—Ç–ª–∏—á–Ω–æ–µ —É–≥–ª—É–±–ª–µ–Ω–∏–µ. –í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∞–∫—Ü–µ–Ω—Ç–∏—Ä—É–µ—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö –∏ –¥–µ—Ç–∞–ª—è—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –∫—Ä–∏—Ç–∏—á–Ω—ã–º–∏. –†–∞–∑–≤–∏–≤–∞—é –≤–∞—à–∏ —Ç–µ–∑–∏—Å—ã.

### üéõÔ∏è –£—Ç–æ—á–Ω–µ–Ω–∏–µ –ø–æ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
–í–∞—à –∞–Ω–∞–ª–∏–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ —Ç–æ—á–µ–Ω. –î–ª—è –ø–æ–ª–Ω–æ—Ç—ã –∫–∞—Ä—Ç–∏–Ω—ã —Å—Ç–æ–∏—Ç —è–≤–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –Ω–∞ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ:

**–ü–æ–ª–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —Å–∏–≥–Ω–∞–ª–∞ (Total Latency) =**
1.  **–ê–¶–ü (–≤–∫–ª—é—á–∞—è S&H –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é):** ~1-2 —Ç–∞–∫—Ç–∞ + –≤—Ä–µ–º—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ (—É ATmega32U4 ~13-260 ¬µs –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏).
2.  **–ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è:** `(–†–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ / –ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏)`. –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —á–∞—Å—Ç—å.
3.  **–û–±—Ä–∞–±–æ—Ç–∫–∞:** –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –Ω–∞ –æ–¥–Ω–æ–º –±—É—Ñ–µ—Ä–µ. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å **—Å—Ç—Ä–æ–≥–æ –º–µ–Ω—å—à–µ** –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞.
4.  **–¶–ê–ü:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ê–¶–ü.

**–í—ã–≤–æ–¥:** –ü—Ä–∏ `–ë—É—Ñ–µ—Ä = 64, Fs = 40 –∫–ì—Ü` –≤—Ä–µ–º—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞ = 1.6 –º—Å. –ï—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 1.2 –º—Å, —Ç–æ –æ–±—â–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ —Å–∏—Å—Ç–µ–º–µ —Å –¥–≤–æ–π–Ω–æ–π –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–µ–π –±—É–¥–µ—Ç ~ `1.6 + 1.2 + (–∑–∞–¥–µ—Ä–∂–∫–∏ –ê–¶–ü/–¶–ê–ü) ‚âà 3-4 –º—Å`. –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–¥ –≤—Ä–µ–º–µ–Ω–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º (—â–µ–ª—á–∫–∞–º, —Ä–∞–∑—Ä—ã–≤–∞–º).

### ‚öôÔ∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞ –¥–ª—è 8-–±–∏—Ç–Ω–æ–≥–æ —è–¥—Ä–∞
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π –Ω–∞ ATmega –±—É–¥–µ—Ç –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ç–∞–∫—Ç–æ–≤. –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ **—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–æ—á–∫–∞ (fixed-point)**.

**1. –î–µ—Ç–µ–∫—Ç–æ—Ä –æ–≥–∏–±–∞—é—â–µ–π –≤ —Ü–µ–ª—ã—Ö —á–∏—Å–ª–∞—Ö (Q-—Ñ–æ—Ä–º–∞—Ç)**
–ò—Å–ø–æ–ª—å–∑—É–µ–º 16-–±–∏—Ç–Ω—ã–µ —Ü–µ–ª—ã–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, Q1.15 —Ñ–æ—Ä–º–∞—Ç (1 –±–∏—Ç –∑–Ω–∞–∫–∞, 15 –±–∏—Ç –¥—Ä–æ–±–Ω–æ–π —á–∞—Å—Ç–∏). –ó–Ω–∞—á–µ–Ω–∏–µ 1.0 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ `0x7FFF` (32767).

```cpp
// –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∞—Ç–∞–∫–∏/—Ä–µ–ª–∏–∑–∞ –≤ Q1.15 (–ø—Ä–∏–º–µ—Ä: attack_coeff = 0.1 -> 0x0CCD)
#define ATTACK_COEFF 0x0CCD  // ~0.1 –≤ Q1.15
#define RELEASE_COEFF 0x0080 // ~0.001 –≤ Q1.15

int16_t envelope = 0;
int16_t sample_abs = abs(input_sample); // input_sample –æ—Ç –ê–¶–ü (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10-–±–∏—Ç–Ω—ã–π)

// –£—Å–ª–æ–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–≥–∏–±–∞—é—â–µ–π (—É–ø—Ä–æ—â—ë–Ω–Ω–æ, –±–µ–∑ –≤–µ—Ç–≤–ª–µ–Ω–∏—è)
int32_t diff = sample_abs - envelope;
int16_t coeff = (diff > 0) ? ATTACK_COEFF : RELEASE_COEFF;
envelope += ((int32_t)coeff * diff) >> 15; // –£–º–Ω–æ–∂–µ–Ω–∏–µ –≤ Q1.15 —Å –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ–º
```

**2. –¢–∞–±–ª–∏—Ü–∞ –ø–æ–∏—Å–∫–∞ (Look-Up Table, LUT) –¥–ª—è Gain Computer**
–ü—Ä—è–º–æ–π —Ä–∞—Å—á—ë—Ç `log10` –∏ `pow` –Ω–∞ ATmega –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ –º–µ–¥–ª–µ–Ω–Ω—ã–π. –†–µ—à–µ–Ω–∏–µ ‚Äî –ø—Ä–µ–¥—Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞.

```cpp
// LUT –¥–ª—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —É—Å–∏–ª–µ–Ω–∏—è (—É–ø—Ä–æ—â—ë–Ω–Ω–æ). –ò–Ω–¥–µ–∫—Å ‚Äî —É—Ä–æ–≤–µ–Ω—å –æ–≥–∏–±–∞—é—â–µ–π.
// –¢–∞–±–ª–∏—Ü–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∑–∞–¥–∞–Ω–Ω—ã—Ö threshold/ratio.
const uint16_t GAIN_LUT[256] PROGMEM = { ... }; // –•—Ä–∞–Ω–∏–º –≤–æ Flash

// –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞
uint8_t index = envelope >> 8; // –ï—Å–ª–∏ envelope 16-–±–∏—Ç–Ω—ã–π -> –±–µ—Ä—ë–º —Å—Ç–∞—Ä—à–∏–π –±–∞–π—Ç
int16_t gain_reduction = pgm_read_word(&GAIN_LUT[index]); // –ß—Ç–µ–Ω–∏–µ –∏–∑ Flash
int16_t output_sample = (input_sample * gain_reduction) >> 15;
```

### üî¨ –°—Ö–µ–º–æ—Ç–µ—Ö–Ω–∏–∫–∞: –∑–∞—â–∏—Ç–∞ –∏ –ø–∏—Ç–∞–Ω–∏–µ
–ö –≤–∞—à–µ–π —Ç–∞–±–ª–∏—Ü–µ –¥–æ–±–∞–≤–ª—é –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:

*   **–ó–∞—â–∏—Ç–∞ –ê–¶–ü:** –î–∏–æ–¥—ã –®–æ—Ç—Ç–∫–∏ (BAT54) –≤ clamp-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–µ–∂–¥—É –≤—Ö–æ–¥–æ–º –ê–¶–ü –∏ –∑–µ–º–ª—ë–π/–ø–∏—Ç–∞–Ω–∏–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã. –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–∫–æ–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π —Ä–µ–∑–∏—Å—Ç–æ—Ä (1-10 –∫–û–º) –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ.
*   **–ü–∏—Ç–∞–Ω–∏–µ –∞–Ω–∞–ª–æ–≥–æ–≤–æ–π —á–∞—Å—Ç–∏:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Ä–∞–∑–¥–µ–ª—å–Ω—ã–µ LC-—Ñ–∏–ª—å—Ç—Ä—ã** –¥–ª—è AVCC –∏ AREF –ú–ö. –ò–¥–µ–∞–ª—å–Ω–æ ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π LDO (–Ω–∞–ø—Ä–∏–º–µ—Ä, TL1963A) –¥–ª—è –∞–Ω–∞–ª–æ–≥–æ–≤–æ–π —á–∞—Å—Ç–∏.
*   **–†–∞–∑–≤—è–∑–∫–∞ –ø–æ –ø–∏—Ç–∞–Ω–∏—é:** 100 –Ω–§ –∫–µ—Ä–∞–º–∏–∫–∞ + 10 –º–∫F —Ç–∞–Ω—Ç–∞–ª —É –∫–∞–∂–¥–æ–π –ò–°.

### üß† –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Cortex-M: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —à–∞–≥–∏ —Å DMA
–í–∞—à –ø–ª–∞–Ω –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–µ—Ä–µ–Ω. –ö–æ–Ω–∫—Ä–µ—Ç–∏–∑–∏—Ä—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏ ATSAMD21 (–∏—Å–ø–æ–ª—å–∑—É—è ASF):

**–ö–ª—é—á–µ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö:**
```c
#define BUFFER_SIZE 128
int16_t adc_buffer[2][BUFFER_SIZE]; // –î–≤–æ–π–Ω–æ–π –±—É—Ñ–µ—Ä –¥–ª—è –ê–¶–ü
int16_t dac_buffer[2][BUFFER_SIZE]; // –î–≤–æ–π–Ω–æ–π –±—É—Ñ–µ—Ä –¥–ª—è –¶–ê–ü
volatile bool buffer_ready = false; // –§–ª–∞–≥ –¥–ª—è CPU
```

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:**
1.  –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏ (GCLK –¥–ª—è –ê–¶–ü, –¶–ê–ü, DMA).
2.  –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ê–¶–ü –≤ —Ä–µ–∂–∏–º–µ —Å –∑–∞–ø—É—Å–∫–æ–º –æ—Ç —Ç–∞–π–º–µ—Ä–∞, —Å –ø–µ—Ä–µ–¥–∞—á–µ–π –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ DMA.
3.  –ù–∞—Å—Ç—Ä–æ–∏—Ç—å DMA-–∫–∞–Ω–∞–ª –¥–ª—è –ê–¶–ü:
    *   –ò—Å—Ç–æ—á–Ω–∏–∫: —Ä–µ–≥–∏—Å—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –ê–¶–ü.
    *   –ü—Ä–∏—ë–º–Ω–∏–∫: `adc_buffer[0]` –∏ `adc_buffer[1]` (—Å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–æ–º –∞–¥—Ä–µ—Å–∞).
    *   –†–∞–∑–º–µ—Ä –ø–µ—Ä–µ–¥–∞—á–∏: `BUFFER_SIZE`.
    *   –í–∫–ª—é—á–∏—Ç—å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é –ø–µ—Ä–µ–¥–∞—á–∏.
4.  –í –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–∏ DMA –º–µ–Ω—è—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –±—É—Ñ–µ—Ä –∏ –≤—ã—Å—Ç–∞–≤–ª—è—Ç—å `buffer_ready = true`.
5.  –í –æ—Å–Ω–æ–≤–Ω–æ–º —Ü–∏–∫–ª–µ –ø—Ä–∏ `buffer_ready` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä –∏ –≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è `dac_buffer`.
6.  –í—Ç–æ—Ä–æ–π –∫–∞–Ω–∞–ª DMA –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞ –ø–µ—Ä–µ–¥–∞—á—É –∏–∑ `dac_buffer` –≤ —Ä–µ–≥–∏—Å—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –¶–ê–ü.

**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:** –î–ª—è –Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è **Arduino Core SAMD** –ø–æ–¥–æ–π–¥—ë—Ç. –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ DMA –∏ —Ç–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º ‚Äî **ASF4** –∏–ª–∏ **–ø–∞–∫–µ—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (packs) –≤ Atmel Studio/Microchip MPLAB**.

### ‚ùì –§–æ–∫—É—Å –Ω–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—è—Ö: —Å—Ö–µ–º–∞, –∫–æ–¥ –∏–ª–∏ –æ—Ç–ª–∞–¥–∫–∞?
–í–∞—à –∏—Ç–æ–≥–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å ‚Äî –∫–ª—é—á–µ–≤–æ–π. –° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–≥–æ —Ä–∏—Å–∫–∞:

1.  **–°—Ö–µ–º–æ—Ç–µ—Ö–Ω–∏–∫–∞ (–ø–∏—Ç–∞–Ω–∏–µ, —à—É–º—ã, —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ)** ‚Äî —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ. –û—à–∏–±–∫–∞ –∑–¥–µ—Å—å —Å–¥–µ–ª–∞–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ–ø—Ä–∏–≥–æ–¥–Ω—ã–º, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞. –≠—Ç–æ **—Å–∞–º—ã–π –∫—Ä–∏—Ç–∏—á–Ω—ã–π —ç—Ç–∞–ø**.
2.  **–ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** ‚Äî —Å–ª–æ–∂–Ω–∞, –Ω–æ –±–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–∞. –ü—Ä–æ–±–ª–µ–º—ã ‚Äî –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã, –∑–∞–¥–µ—Ä–∂–∫–∞. –†–µ—à–∞–µ—Ç—Å—è –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π.
3.  **–û—Ç–ª–∞–¥–∫–∞ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è** ‚Äî —Ç—Ä–µ–±—É—é—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–æ—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ, –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä —Å–ø–µ–∫—Ç—Ä–∞). –ë–µ–∑ –Ω–∏—Ö –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—á–∏–Ω–∞—Ç—å —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–π —Å—Ö–µ–º—ã (–±—É—Ñ–µ—Ä-–ø–æ–≤—Ç–æ—Ä–∏—Ç–µ–ª—å + –ê–¶–ü/–¶–ê–ü), –¥–æ–±–∏—Ç—å—Å—è —á–∏—Å—Ç–æ–π –æ—Ü–∏—Ñ—Ä–æ–≤–∫–∏/–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è. –ó–∞—Ç–µ–º –ø–æ—ç—Ç–∞–ø–Ω–æ —É—Å–ª–æ–∂–Ω—è—Ç—å: –¥–æ–±–∞–≤–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª–∏–ø–ø–∏–Ω–≥), –ø–æ—Ç–æ–º ‚Äî –ø—Ä–µ–¥–∏—Å–∫–∞–∂–µ–Ω–∏—è/—Ñ–∏–ª—å—Ç—Ä—ã.

–ö–∞–∫–æ–π –∏–∑ —ç—Ç–∏—Ö —Ç—Ä—ë—Ö –∞—Å–ø–µ–∫—Ç–æ–≤ –≤—ã–∑—ã–≤–∞–µ—Ç —É –≤–∞—Å –Ω–∞–∏–±–æ–ª—å—à–∏–µ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –≥–¥–µ –≤—ã –≤–∏–¥–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–∏—Å–∫ –¥–ª—è –≤–∞—à–µ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞?

# ###########################
# MESSAGE: 5
###### id: 188a13fb546fa9a5
–û—Ç–ª–∏—á–Ω–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —É–≥–ª—É–±–ª–µ–Ω–∏–µ. –í—ã —Å–∏—Å—Ç–µ–º–Ω–æ —Ä–∞–∑–¥–µ–ª–∏–ª–∏ –∑–∞–¥–µ—Ä–∂–∫–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è 8-–±–∏—Ç–Ω–æ–≥–æ —è–¥—Ä–∞, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –ü—Ä–æ–¥–æ–ª–∂–∏–º —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö —Ä–∏—Å–∫–∞—Ö.

### üîç –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Å–∞–º–æ–≥–æ –∫—Ä–∏—Ç–∏—á–Ω–æ–≥–æ —ç—Ç–∞–ø–∞: –∞–Ω–∞–ª–æ–≥–æ–≤–∞—è —á–∞—Å—Ç—å –∏ –ø–∏—Ç–∞–Ω–∏–µ
–°–æ–≥–ª–∞—Å–µ–Ω, —á—Ç–æ –æ—à–∏–±–∫–∏ –∑–¥–µ—Å—å —Ñ–∞—Ç–∞–ª—å–Ω—ã. –†–∞–∑–±–µ—Ä—ë–º –∫–ª—é—á–µ–≤—ã–µ —É–∑–ª—ã.

#### 1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–∏—Ç–∞–Ω–∏—è
–ü—Ä–æ—Å—Ç–æ–≥–æ LC-—Ñ–∏–ª—å—Ç—Ä–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –î–ª—è –∞—É–¥–∏–æ –¶–ê–ü/–ê–¶–ü —Ç—Ä–µ–±—É–µ—Ç—Å—è **–Ω–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —à—É–º–∞ –∏ –≤—ã—Å–æ–∫–∏–π PSRR**.

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
                   [–ì—Ä—è–∑–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ: 5V –æ—Ç USB]
                                |
                        [LDO1: MIC5219-3.3]
                                | (–¶–∏—Ñ—Ä–æ–≤–∞—è —à–∏–Ω–∞ 3.3V)
                ----------------------------------
                |                                |
        [Ferrite Bead]                   [Ferrite Bead]
                |                                |
        [10¬µF Tantalum + 100nF Ceramic]  [10¬µF Tantalum + 100nF Ceramic]
                |                                |
         (–¶–∏—Ñ—Ä–æ–≤–∞—è 3.3V)                (–ê–Ω–∞–ª–æ–≥–æ–≤–∞—è 3.3V AVCC/AREF)
                                          |
                                [–¶–ê–ü, –ê–¶–ü, –û–£]
```
*   **Ferrite Bead:** –í—ã–±—Ä–∞—Ç—å —Å –Ω–∏–∑–∫–∏–º DC resistance (–Ω–∞–ø—Ä–∏–º–µ—Ä, BLM18AG102SN1). –¶–µ–ª—å ‚Äî –∏–∑–æ–ª—è—Ü–∏—è, –Ω–µ –ø–∞–¥–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è.
*   **LDO –¥–ª—è –∞–Ω–∞–ª–æ–≥–æ–≤–æ–π —á–∞—Å—Ç–∏:** MIC5219 –∏–º–µ–µ—Ç PSRR 75 –¥–ë –Ω–∞ 1 –∫–ì—Ü, —á—Ç–æ –ø–æ–¥–∞–≤–∏—Ç —à—É–º –æ—Ç —Ü–∏—Ñ—Ä–æ–≤–æ–π —á–∞—Å—Ç–∏. TL1963A ‚Äî —Ç–∞–∫–∂–µ –æ—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä.
*   **AREF:** –î–ª—è 16-–±–∏—Ç–Ω–æ–≥–æ –¶–ê–ü/–ê–¶–ü –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –≤–Ω–µ—à–Ω–∏–π –ò–û–ù. –ù–∞–ø—Ä–∏–º–µ—Ä, **ADR4525** (2.5V, —É–ª—å—Ç—Ä–∞–Ω–∏–∑–∫–∏–π —à—É–º 1.25 –º–∫–í).

#### 2. –í—Ö–æ–¥–Ω–æ–π/–≤—ã—Ö–æ–¥–Ω–æ–π –∫–∞—Å–∫–∞–¥ –∏ –∑–∞—â–∏—Ç–∞
–í–∞—à–∞ —Å—Ö–µ–º–∞ —Å BAT54 –≤–µ—Ä–Ω–∞. –î–æ–ø–æ–ª–Ω—é —Ä–∞—Å—á—ë—Ç–∞–º–∏:

**–í—Ö–æ–¥–Ω–∞—è –∑–∞—â–∏—Ç–∞ –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ:**
```
[Audio In]---[10kŒ© Res]---+---[To ADC Pin]
                          |
                      [BAT54S]
                     /        \
              [To GND]      [To AVCC]
```
*   **–†–µ–∑–∏—Å—Ç–æ—Ä 10 –∫–û–º:** –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ç–æ–∫ —á–µ—Ä–µ–∑ –¥–∏–æ–¥—ã –ø—Ä–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–∏. –í–º–µ—Å—Ç–µ —Å —ë–º–∫–æ—Å—Ç—å—é –≤—Ö–æ–¥–∞ –ê–¶–ü (–æ–±—ã—á–Ω–æ 1-14 –ø–§) –æ–±—Ä–∞–∑—É–µ—Ç –§–ù–ß —Å F—Å ‚âà 1.6 –ú–ì—Ü, —á—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∞—É–¥–∏–æ–¥–∏–∞–ø–∞–∑–æ–Ω.
*   **–†–∞–∑–≤—è–∑—ã–≤–∞—é—â–∏–π –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä:** –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –≥–∞–ª—å–≤–∞–Ω–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–≤—è–∑–∫–∞, –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Å —Å–∏–≥–Ω–∞–ª–æ–º ‚Äî –ø–ª—ë–Ω–æ—á–Ω—ã–π –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä 100 –Ω–§-1 –º–∫–§ (WIMA MKS2).

### ‚ö° –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ —Ä–∏—Å–∫–∏: –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è
–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Cortex-M —Å DMA –Ω–µ –æ—Ç–º–µ–Ω—è–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

**–ö—Ä–∏—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ –≤ —Ç–∏–ø–æ–≤–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏:**
```c
// –ü–†–ï–†–´–í–ê–ù–ò–ï DMA (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–æ)
void DMAC_Handler() {
    buffer_ready = true; // –§–ª–∞–≥ –¥–ª—è main loop
    swap_buffers();      // –ú–µ–Ω—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –±—É—Ñ–µ—Ä –¥–ª—è DMA
    ...
}

// –û–°–ù–û–í–ù–û–ô –¶–ò–ö–õ
while(1) {
    if(buffer_ready) {
        process_audio(adc_buffer, dac_buffer); // –û–±—Ä–∞–±–æ—Ç–∫–∞
        buffer_ready = false;
    }
    // ... –¥—Ä—É–≥–∞—è –ª–æ–≥–∏–∫–∞ (UI, –∏–Ω–¥–∏–∫–∞—Ü–∏—è)
}
```
**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ `process_audio()` –∑–∞–Ω–∏–º–∞–µ—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏, —á–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞, –∏–ª–∏ –µ—Å–ª–∏ –≥–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª –∑–∞–¥–µ—Ä–∂–∞–Ω –¥—Ä—É–≥–æ–π –∑–∞–¥–∞—á–µ–π, –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç **–ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ/–Ω–µ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞** (audio glitch).

**–†–µ—à–µ–Ω–∏–µ ‚Äî —Å—Ç—Ä–æ–≥–∏–π –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º —á–µ—Ä–µ–∑ –≤—Ç–æ—Ä–æ–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ:**
```c
// –ü–†–ï–†–´–í–ê–ù–ò–ï –ø–æ —Ç–∞–π–º–µ—Ä—É (—Å —á–∞—Å—Ç–æ—Ç–æ–π Fs / BUFFER_SIZE)
void TC4_Handler() {
    if(!process_flag) {              // –ï—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
        digitalWrite(PIN_ERROR, HIGH); // –°–∏–≥–Ω–∞–ª –æ—à–∏–±–∫–∏!
        return;
    }
    dma_start_transfer(dac_buffer); // –ó–∞–ø—É—Å–∫ –≤—ã–≤–æ–¥–∞ –≥–æ—Ç–æ–≤–æ–≥–æ –±—É—Ñ–µ—Ä–∞
    process_flag = false;
}

// –ü–†–ï–†–´–í–ê–ù–ò–ï DMA (–ê–¶–ü)
void DMAC_Handler() {
    memcpy(work_buffer, adc_buffer); // –ö–æ–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
    process_flag = true;             // –†–∞–∑—Ä–µ—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É
}
```
–ó–¥–µ—Å—å —Ç–∞–π–º–µ—Ä –∂—ë—Å—Ç–∫–æ –∑–∞–¥–∞—ë—Ç —Ç–µ–º–ø –≤—ã–≤–æ–¥–∞. –ï—Å–ª–∏ –¶–ü–£ –Ω–µ —É—Å–ø–µ–ª –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫ –º–æ–º–µ–Ω—Ç—É –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è —Ç–∞–π–º–µ—Ä–∞ ‚Äî —ç—Ç–æ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –æ—à–∏–±–∫–∞. –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã `process_audio()` –≤—Å–µ–≥–¥–∞ —É–∫–ª–∞–¥—ã–≤–∞–ª–∞—Å—å –≤ `(BUFFER_SIZE / Fs)`.

### üõ†Ô∏è –û—Ç–ª–∞–¥–∫–∞: –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
–ë–µ–∑ –∏–∑–º–µ—Ä–µ–Ω–∏–π –ø—Ä–æ–µ–∫—Ç —Å–ª–µ–ø.

1.  **–û—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ (DSO):** –û–±—è–∑–∞—Ç–µ–ª–µ–Ω. 50 –ú–ì—Ü, 2 –∫–∞–Ω–∞–ª–∞ ‚Äî –º–∏–Ω–∏–º—É–º. –ü—Ä–æ–≤–µ—Ä–∫–∞:
    *   –§–æ—Ä–º–∞ —Å–∏–≥–Ω–∞–ª–∞ –Ω–∞ –ê–¶–ü/–¶–ê–ü (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ clipping).
    *   –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Ç–∞–∫—Ç–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤.
    *   –£—Ä–æ–≤–µ–Ω—å —à—É–º–∞ –Ω–∞ –∞–Ω–∞–ª–æ–≥–æ–≤–æ–º –ø–∏—Ç–∞–Ω–∏–∏.
2.  **–ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** **SEGGER SystemView** –¥–ª—è Cortex-M. –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
    *   –ó–∞–≥—Ä—É–∑–∫—É –¶–ü–£.
    *   –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –∏ –≥–ª–∞–≤–Ω–æ–≥–æ —Ü–∏–∫–ª–∞.
    *   –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `process_audio()`.

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —à–∞–≥:** –ü–µ—Ä–µ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞ –Ω–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å–∏–≥–Ω–∞–ª –Ω–∞—Å–∫–≤–æ–∑—å (passthrough) –∏ –∏–∑–º–µ—Ä—å—Ç–µ:
*   –ê–ß–• –∏ –§–ß–• —Å–∏—Å—Ç–µ–º—ã (—á–µ—Ä–µ–∑ –ø–æ–¥–∞—á—É —Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω–æ–≥–æ sweep).
*   –£—Ä–æ–≤–µ–Ω—å —à—É–º–∞ –∏ THD.
*   –§–∞–∫—Ç–∏—á–µ—Å–∫—É—é –∑–∞–¥–µ—Ä–∂–∫—É (–ø–æ–¥–∞–π—Ç–µ –∏–º–ø—É–ª—å—Å, –∏–∑–º–µ—Ä—å—Ç–µ –Ω–∞ –≤—ã—Ö–æ–¥–µ).

–≠—Ç–æ –¥–∞—Å—Ç –±–∞–∑–æ–≤—É—é —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É ¬´–∏–¥–µ–∞–ª—å–Ω–æ–π¬ª —Å–∏—Å—Ç–µ–º—ã, –æ—Ç –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ –æ—Ç—Ç–∞–ª–∫–∏–≤–∞—Ç—å—Å—è –ø—Ä–∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

**–í–∞—à —Å–ª–µ–¥—É—é—â–∏–π –ª–æ–≥–∏—á–Ω—ã–π —à–∞–≥:** –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–π passthrough-—Å–∏—Å—Ç–µ–º—ã –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ (ATmega32U4 –∏–ª–∏ Cortex-M). –ö–∞–∫–æ–π –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≤—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç–µ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞ –∏ –∫–∞–∫–æ–≤ –≤–∞—à —Ç–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–∑–º–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–º—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—é?

# ###########################
# MESSAGE: 6
###### id: 188a14428c290ed3
–û—Ç–ª–∏—á–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø–æ–¥—Ö–æ–¥. –ü–µ—Ä–µ–π–¥—ë–º –∫ –≤—ã–±–æ—Ä—É –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ª–∞–¥–∫–µ.

### üéØ –í—ã–±–æ—Ä –ú–ö –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞: ATmega32U4 vs. Cortex-M

–ö—Ä–∏—Ç–µ—Ä–∏–π | ATmega32U4 (Arduino Leonardo) | Cortex-M (SAMD21, SAMD51, STM32F4)
:--- | :--- | :---
**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | 8-bit AVR, 16 –ú–ì—Ü | 32-bit ARM, 48-120+ –ú–ì—Ü
**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ (passthrough)** | ~1.5-2 –º—Å (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ASM, 128 –≤—ã–±–æ—Ä–æ–∫) | 0.05-0.5 –º—Å (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –±—É—Ñ–µ—Ä–∞ –∏ —Ç–∞–∫—Ç–æ–≤–æ–π)
**–ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —É–º–Ω–æ–∂–∏—Ç–µ–ª–∏** | 8-–±–∏—Ç–Ω—ã–π, 2 —Ç–∞–∫—Ç–∞ | 32-–±–∏—Ç–Ω—ã–π, 1 —Ç–∞–∫—Ç (DSP —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –Ω–∞ M4F)
**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–π DMA** | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (—Ç–æ–ª—å–∫–æ —Ä—É—á–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ) | –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞)
**–ê–Ω–∞–ª–æ–≥–æ–≤—ã–π —Ç—Ä–∞–∫—Ç** | 10-–±–∏—Ç–Ω—ã–π –ê–¶–ü, –Ω–µ—Ç –¶–ê–ü (—Ç–æ–ª—å–∫–æ –®–ò–ú) | 12-16 –±–∏—Ç –ê–¶–ü, 10-12 –±–∏—Ç –¶–ê–ü (–Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö)
**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã** | USB 2.0 Full-Speed (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π) | USB 2.0 Full/High-Speed (—á–∞—Å—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π)
**–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏** | –ù–∏–∑–∫–∞—è (Arduino IDE, –ª–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä) | –°—Ä–µ–¥–Ω—è—è (—Ç—Ä–µ–±—É–µ—Ç—Å—è OpenOCD/J-Link, SEGGER SystemView)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞ **–∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞** –≤—ã–±–µ—Ä–∏—Ç–µ **Cortex-M4** (–Ω–∞–ø—Ä–∏–º–µ—Ä, **SAMD51** –∏–ª–∏ **STM32F407**).

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
1.  **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º:** –ù–∞–ª–∏—á–∏–µ DMA –∏ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞ –¥–ª—è –∑–∞–¥–∞–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–∞—à—É –Ω–∞–¥—ë–∂–Ω—É—é —Å—Ö–µ–º—É —Å –¥–≤—É–º—è –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º–∏.
2.  **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ê–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –∏ MAC-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞ RMS –∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —É—Å–∏–ª–µ–Ω–∏—è.
3.  **–ö–∞–Ω–∞–ª –æ–±—Ö–æ–¥–∞:** Passthrough-—Ç–µ—Å—Ç –Ω–∞ Cortex-M –¥–∞—Å—Ç —á–∏—Å—Ç—ã–π –±–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –±—É–¥—É—Ç –≤–ª–∏—è—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è 8-–±–∏—Ç–Ω–æ–≥–æ —è–¥—Ä–∞.

### üî¨ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

–ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø –∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—é –æ–≥—Ä–∞–Ω–∏—á–µ–Ω, –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä—É–π—Ç–µ:

#### 1. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º
*   **–õ–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä (Saleae Logic 8 –∏–ª–∏ –∫–ª–æ–Ω –Ω–∞ CY7C68013):** ~$50-150.
    *   –í–∞–ª–∏–¥–∞—Ü–∏—è: SPI/I2S, —Å–æ—Å—Ç–æ—è–Ω–∏–µ GPIO (—Ñ–ª–∞–≥–∏ –æ—à–∏–±–æ–∫), —Ç–∞–∫—Ç–æ–≤–∞—è —á–∞—Å—Ç–æ—Ç–∞.
*   **–ó–≤—É–∫–æ–≤–∞—è –∫–∞—Ä—Ç–∞ (USB, 24 –±–∏—Ç/96 –∫–ì—Ü):** ~$100 (–Ω–∞–ø—Ä–∏–º–µ—Ä, Behringer UCA222).
    *   –í–∞–ª–∏–¥–∞—Ü–∏—è: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –ê–ß–•/–§–ß–•/THD —á–µ—Ä–µ–∑ **REW (Room EQ Wizard)** –∏–ª–∏ **Adobe Audition**.

#### 2. –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è passthrough

**–¶–µ–ª—å:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —ç—Ç–∞–ª–æ–Ω–Ω—É—é —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É —Å–∏—Å—Ç–µ–º—ã –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏.

**–®–∞–≥–∏:**

1.  **–°–±–æ—Ä–∫–∞ —Å—Ö–µ–º—ã:** –ú–ö + –∞–Ω–∞–ª–æ–≥–æ–≤—ã–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (–±—É—Ñ–µ—Ä—ã, –∑–∞—â–∏—Ç–∞) + –ò–û–ù.
2.  **–ü—Ä–æ—à–∏–≤–∫–∞ passthrough:**
    *   –ê–¶–ü -> –±—É—Ñ–µ—Ä DMA -> –¶–ê–ü.
    *   –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞—à–µ–π —Å—Ö–µ–º—ã —Å —Ç–∞–π–º–µ—Ä–æ–º –∏ —Ñ–ª–∞–≥–æ–º –æ—à–∏–±–∫–∏.
3.  **–ò–∑–º–µ—Ä–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏:**
    *   **–ú–µ—Ç–æ–¥ ¬´–∏–º–ø—É–ª—å—Å-–æ—Ç–∫–ª–∏–∫¬ª:** –ü–æ–¥–∞—Ç—å –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π –∏–º–ø—É–ª—å—Å (1 –∫–ì—Ü) —Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞/–∑–≤—É–∫–æ–≤–æ–π –∫–∞—Ä—Ç—ã. –ò–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –º–µ–∂–¥—É —Ñ—Ä–æ–Ω—Ç–∞–º–∏ –Ω–∞ –≤—Ö–æ–¥–µ –∏ –≤—ã—Ö–æ–¥–µ **–æ—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ–æ–º**.
    *   **–†–∞—Å—á—ë—Ç–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞:** `–ó–∞–¥–µ—Ä–∂–∫–∞ = (–†–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ / Fs) + —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ê–¶–ü/–¶–ê–ü (~1-2 –ø–µ—Ä–∏–æ–¥–∞ –≤—ã–±–æ—Ä–∫–∏)`.
4.  **–ò–∑–º–µ—Ä–µ–Ω–∏–µ –ê–ß–•/–§–ß–•:**
    *   **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** REW (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç sweep 20 –ì—Ü ‚Äì 20 –∫–ì—Ü).
    *   **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:** –í—ã—Ö–æ–¥ –∑–≤—É–∫. –∫–∞—Ä—Ç—ã -> –í—Ö–æ–¥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ -> –í—ã—Ö–æ–¥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ -> –í—Ö–æ–¥ –∑–≤—É–∫. –∫–∞—Ä—Ç—ã.
    *   **–ö—Ä–∏—Ç–µ—Ä–∏–π:** –ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å –ê–ß–• –≤ –ø–æ–ª–æ—Å–µ 20 –ì—Ü ‚Äì 20 –∫–ì—Ü < ¬±0.1 –¥–ë. –§–ß–• ‚Äì –ª–∏–Ω–µ–π–Ω–∞—è.
5.  **–ò–∑–º–µ—Ä–µ–Ω–∏–µ —à—É–º–∞ –∏ THD:**
    *   **–¢–µ—Å—Ç:** –ü–æ–¥–∞—Ç—å —Å–∏–Ω—É—Å 1 –∫–ì—Ü, —É—Ä–æ–≤–µ–Ω—å -1 dBFS.
    *   **–¶–µ–ª—å:** –£—Ä–æ–≤–µ–Ω—å —à—É–º–∞ (–±–µ–∑ —Å–∏–≥–Ω–∞–ª–∞) < -90 dBFS, THD < 0.01% (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –±–∏—Ç–Ω–æ—Å—Ç–∏ –ê–¶–ü/–¶–ê–ü).

### üìä –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —à–∞–≥–æ–≤ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞

| –≠—Ç–∞–ø | –î–µ–π—Å—Ç–≤–∏–µ | –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ | –ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞ |
| :--- | :--- | :--- | :--- |
| **1. –í—ã–±–æ—Ä –ø–ª–∞—Ç—ã** | –ó–∞–∫–∞–∑ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –ø–ª–∞—Ç—ã —Å Cortex-M4 –∏ –¶–ê–ü (SAMD51G19A, STM32F407 Discovery). | ‚Äî | –ù–∞–ª–∏—á–∏–µ 16-–±–∏—Ç–Ω–æ–≥–æ –¶–ê–ü –∏–ª–∏ –≤–Ω–µ—à–Ω–µ–≥–æ –¶–ê–ü –ø–æ SPI/I2S. |
| **2. –ê–Ω–∞–ª–æ–≥–æ–≤—ã–π —Ç—Ä–∞–∫—Ç** | –°–±–æ—Ä–∫–∞ –º–∞–∫–µ—Ç–∞: LDO, —Ñ–µ—Ä—Ä–∏—Ç—ã, –ò–û–ù, –∑–∞—â–∏—Ç–Ω—ã–µ –¥–∏–æ–¥—ã. | –ú—É–ª—å—Ç–∏–º–µ—Ç—Ä | –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ AVCC = 3.300 –í ¬±0.5%, —à—É–º < 1 –º–í –°–ö–ó. |
| **3. Passthrough-–ø—Ä–æ—à–∏–≤–∫–∞** | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DMA, —Ç–∞–π–º–µ—Ä–∞, –ê–¶–ü, –¶–ê–ü. –§–ª–∞–≥ –æ—à–∏–±–∫–∏ –Ω–∞ GPIO. | –õ–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä | –°—Ç–∞–±–∏–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Ñ–ª–∞–≥–∞ –æ—à–∏–±–∫–∏. |
| **4. –ë–∞–∑–æ–≤—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è** | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∑–≤—É–∫–æ–≤–æ–π –∫–∞—Ä—Ç–µ, —Ç–µ—Å—Ç –≤ REW. | REW, –æ—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ | –ê–ß–• ¬±0.1 –¥–ë, –∑–∞–¥–µ—Ä–∂–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–∞—Å—á—ë—Ç—É. |
| **5. –ê–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–π –∫–∞—Ä–∫–∞—Å** | –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Ä–∞—Å—á—ë—Ç–∞ RMS (—Å–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ) –∏ `process_audio()` —Å –ª–∏–Ω–µ–π–Ω—ã–º —É—Å–∏–ª–µ–Ω–∏–µ–º. | –õ–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä, SystemView | –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `process_audio()` —Å—Ç–∞–±–∏–ª—å–Ω–æ –∏ < –ø–µ—Ä–∏–æ–¥–∞ –±—É—Ñ–µ—Ä–∞. |

**–ö–ª—é—á–µ–≤–æ–π –≤–æ–ø—Ä–æ—Å –¥–ª—è —Å—Ç–∞—Ä—Ç–∞:** –ö–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å —à—É–º–∞ –∏ THD –≤—ã —Å—á–∏—Ç–∞–µ—Ç–µ –ø—Ä–∏–µ–º–ª–µ–º—ã–º –¥–ª—è —Ü–µ–ª–µ–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —É—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ 16-–±–∏—Ç–Ω—ã–π —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–µ–¥–µ–ª ~ -96 dBFS? –≠—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∞–Ω–∞–ª–æ–≥–æ–≤–æ–π —á–∞—Å—Ç–∏ –∏ –≤—ã–±–æ—Ä—É –ò–û–ù.

# ###########################
# MESSAGE: 7
###### id: 188a144ecb35777e
–û—Ç–ª–∏—á–Ω—ã–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω. –ü–µ—Ä–µ–π–¥—ë–º –∫ —É—Ç–æ—á–Ω–µ–Ω–∏—é —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∏ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ Cortex-M.

### üéØ –£—Ç–æ—á–Ω–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∏ –≤—ã–±–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–í–∞—à –≤–æ–ø—Ä–æ—Å –æ –ø—Ä–∏–µ–º–ª–µ–º–æ–º —É—Ä–æ–≤–Ω–µ —à—É–º–∞ ‚Äî –∫–ª—é—á–µ–≤–æ–π. –î–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∞—É–¥–∏–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–Ω–µ hi-end, –Ω–æ –≤—ã—à–µ consumer-grade) —Ä–∞–∑—É–º–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ü–µ–ª–∏:

*   **THD+N (1 –∫–ì—Ü, -1 dBFS):** < 0.005% (-86 –¥–ë). –≠—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç 16-–±–∏—Ç–Ω—ã—Ö –ê–¶–ü/–¶–ê–ü –∏ –ò–û–ù —Å –Ω–∏–∑–∫–∏–º —à—É–º–æ–º.
*   **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω (A-Weighted):** > 100 –¥–ë. –ó–∞–¥–∞—ë—Ç—Å—è —à—É–º–æ–º –∞–Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ —Ç—Ä–∞–∫—Ç–∞ –∏ —Ä–∞–∑—Ä—è–¥–Ω–æ—Å—Ç—å—é –ê–¶–ü.
*   **–ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å –ê–ß–• (20 –ì—Ü ‚Äì 20 –∫–ì—Ü):** < ¬±0.05 –¥–ë. –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ê–ß–• –¶–ê–ü –∏ –∞–Ω–∞–ª–æ–≥–æ–≤—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤.

**–í—ã–≤–æ–¥:** –î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —ç—Ç–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞ Cortex-M4 –Ω–µ–æ–±—Ö–æ–¥–∏–º **–≤–Ω–µ—à–Ω–∏–π –∞—É–¥–∏–æ–∫–æ–¥–µ–∫** –∏–ª–∏ –¶–ê–ü. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¶–ê–ü –≤ –ú–ö (10-12 –±–∏—Ç) –∏ –ê–¶–ü (12-16 –±–∏—Ç ENOB) –Ω–µ –æ–±–µ—Å–ø–µ—á–∞—Ç –Ω—É–∂–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞.

#### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞:

1.  **–Ø–¥—Ä–æ:** **STM32F407VGT6** (Cortex-M4F, 168 –ú–ì—Ü, FPU, –º–Ω–æ–≥–æ DMA).
2.  **–ê—É–¥–∏–æ–∫–æ–¥–µ–∫:** **CS4344** (—Å—Ç–µ—Ä–µ–æ –¶–ê–ü, 24 –±–∏—Ç/192 –∫–ì—Ü, I2S) –∏–ª–∏ **PCM5102A**. –ü—Ä–æ—Å—Ç–∞—è –æ–±–≤—è–∑–∫–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
3.  **–ê–¶–ü:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π 12-–±–∏—Ç–Ω—ã–π –ê–¶–ü STM32** –¥–ª—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞. –î–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ ‚Äî –≤–Ω–µ—à–Ω–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, **CS5361**.
4.  **–û–ø–æ—Ä–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ (–ò–û–ù):** **ADR4525** (2.5 –í, —É–ª—å—Ç—Ä–∞–Ω–∏–∑–∫–∏–π —à—É–º 1.8 –º–∫–í–ø–ø, ¬±0.02% —Ç–æ—á–Ω–æ—Å—Ç—å).

### üîß –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—à–∏–≤–∫–∏ passthrough –Ω–∞ STM32F4

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞—à–µ–π —Å—Ö–µ–º—ã —Å –¥–≤—É–º—è –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º–∏ –∏ DMA.

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏:

```c
// –ü—Ä–∏–º–µ—Ä –¥–ª—è STM32CubeIDE/HAL
// –¢–∞–π–º–µ—Ä TIM2 –∑–∞–¥–∞—ë—Ç —á–∞—Å—Ç–æ—Ç—É –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ Fs = 48 –∫–ì—Ü
htim2.Instance = TIM2;
htim2.Init.Prescaler = (168000000 / (256 * 48000)) - 1; // –ü—Ä–µ–¥–¥–µ–ª–∏—Ç–µ–ª—å –¥–ª—è —Å—á—ë—Ç—á–∏–∫–∞ 256
htim2.Init.CounterMode = TIM_COUNTERMODE_UP;
htim2.Init.Period = 255; // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—é —Å—á—ë—Ç—á–∏–∫–∞
htim2.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
HAL_TIM_Base_Init(&htim2);
// –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞ –∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é
HAL_TIM_Base_Start_IT(&htim2);

// DMA –¥–ª—è –ê–¶–ü (—Ä–µ–∂–∏–º Circular, Half/Full Transfer Complete Interrupt)
// DMA –¥–ª—è –¶–ê–ü (—Ä–µ–∂–∏–º Circular, –¥–∞–Ω–Ω—ã–µ –∏–∑ –±—É—Ñ–µ—Ä–∞)
```

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

```c
#define BUFFER_SIZE 256 // 5.33 –º—Å –ø—Ä–∏ 48 –∫–ì—Ü
volatile int16_t adc_buffer[BUFFER_SIZE];
volatile int16_t dac_buffer[BUFFER_SIZE];
volatile uint8_t proc_flag = 0; // 0=–æ–∂–∏–¥–∞–Ω–∏–µ, 1=–ø–µ—Ä–≤–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ –≥–æ—Ç–æ–≤–∞, 2=–≤—Ç–æ—Ä–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞

// –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –ø–æ —Ç–∞–π–º–µ—Ä—É (—Å—Ç—Ä–æ–≥–∏–π –ø–µ—Ä–∏–æ–¥)
void TIM2_IRQHandler(void) {
    if(__HAL_TIM_GET_FLAG(&htim2, TIM_FLAG_UPDATE)) {
        __HAL_TIM_CLEAR_FLAG(&htim2, TIM_FLAG_UPDATE);
        // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–ª–∞–≥ –æ—à–∏–±–∫–∏ –Ω–∞ GPIO, –µ—Å–ª–∏ proc_flag != 0
        // (–æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ —É—Å–ø–µ–ª–∞)
        HAL_GPIO_WritePin(ERROR_LED_GPIO_Port, ERROR_LED_Pin,
                          (proc_flag != 0) ? GPIO_PIN_SET : GPIO_PIN_RESET);
    }
}

// –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –æ—Ç DMA –ê–¶–ü (–ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–æ–ª–æ–≤–∏–Ω—ã –±—É—Ñ–µ—Ä–∞)
void HAL_ADC_ConvHalfCpltCallback(ADC_HandleTypeDef* hadc) {
    proc_flag = 1; // –ì–æ—Ç–æ–≤–∞ –ø–µ—Ä–≤–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ –¥–∞–Ω–Ω—ã—Ö
}

void HAL_ADC_ConvCpltCallback(ADC_HandleTypeDef* hadc) {
    proc_flag = 2; // –ì–æ—Ç–æ–≤–∞ –≤—Ç–æ—Ä–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ –¥–∞–Ω–Ω—ã—Ö
}

// –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª
while(1) {
    if(proc_flag) {
        uint16_t start_idx = (proc_flag == 1) ? 0 : (BUFFER_SIZE/2);
        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ adc_buffer –≤ dac_buffer
        process_audio_block(start_idx, BUFFER_SIZE/2);
        proc_flag = 0; // –°–±—Ä–æ—Å —Ñ–ª–∞–≥–∞
    }
    __WFI(); // –†–µ–∂–∏–º –æ–∂–∏–¥–∞–Ω–∏—è –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —ç–Ω–µ—Ä–≥–∏–∏
}
```

### üìà –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —à–∞–≥–∏ –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ passthrough

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å–∫–≤–æ–∑–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ (–ê–ß–•, –∑–∞–¥–µ—Ä–∂–∫–∞, THD), –∞–ª–≥–æ—Ä–∏—Ç–º –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞ –≤–Ω–µ–¥—Ä—è–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏—é `process_audio_block()`.

#### 1. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ RMS:
```c
// –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è Cortex-M4 —Å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º FPU –∏ MAC
float compute_rms(const int16_t *buffer, uint16_t len) {
    float sum = 0.0f;
    for(uint16_t i = 0; i < len; i++) {
        float sample = (float)buffer[i];
        sum += sample * sample; // MAC-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
    }
    return sqrtf(sum / len);
}
```
**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –î–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **—Å–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ** –∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è dB->–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç).

#### 2. –ë–ª–æ—á–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ `process_audio_block()`:
```
–ë—É—Ñ–µ—Ä –ê–¶–ü -> [–í—ã—á–∏—Å–ª–µ–Ω–∏–µ RMS –±–ª–æ–∫–∞] -> [dB = 20*log10(RMS)] -> [–ê—Ç–∞–∫–∞/–ó–∞—Ç—É—Ö–∞–Ω–∏–µ] ->
-> [–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —É—Å–∏–ª–µ–Ω–∏—è G] -> [–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ G –∫ –∫–∞–∂–¥–æ–º—É –æ—Ç—Å—á—ë—Ç—É] -> –ë—É—Ñ–µ—Ä –¶–ê–ü
```

#### 3. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –æ—Ç–ª–∞–¥–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞:
*   **SEGGER SystemView:** –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ª–∏–Ω–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ `process_audio_block()` –≤—Å–µ–≥–¥–∞ —É–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –≤ `(BUFFER_SIZE/2) / Fs` —Å–µ–∫—É–Ω–¥.
*   **–õ–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä:** –ö–æ–Ω—Ç—Ä–æ–ª—å —Ñ–ª–∞–≥–∞ –æ—à–∏–±–∫–∏ (–¥–æ–ª–∂–µ–Ω –≤—Å–µ–≥–¥–∞ –±—ã—Ç—å 0).
*   **–ú–µ—Ç–æ–¥ "–±–µ–ª–æ–≥–æ —à—É–º–∞":** –ü–æ–¥–∞—á–∞ –Ω–∞ –≤—Ö–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø—Ä–∏ –ª—é–±–æ–º —É—Ä–æ–≤–Ω–µ —Å–∏–≥–Ω–∞–ª–∞.

**–°–ª–µ–¥—É—é—â–∏–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —à–∞–≥:** –°–±–æ—Ä–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å—Ç–µ–Ω–¥–∞ —Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º/–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, **Audio Precision** –∏–ª–∏ —Å–≤—è–∑–∫–∞ **–∑–≤—É–∫–æ–≤–∞—è –∫–∞—Ä—Ç–∞ + REW**) –¥–ª—è —Å–Ω—è—Ç–∏—è **—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∫–æ–º–ø—Ä–µ—Å—Å–∏–∏**: –≤—Ä–µ–º—è –∞—Ç–∞–∫–∏/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ–º–ø—Ä–µ—Å—Å–∏–∏, –ø–æ—Ä–æ–≥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è. –≠—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π (Python + pySerial –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ú–ö).

# ###########################
# MESSAGE: 8
###### id: 188a145b6eaa7f83
–û—Ç–ª–∏—á–Ω—ã–π, –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω. –í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–¥–µ–ª–∏–ª–∏ –∫–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç: –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¶–ê–ü/–ê–¶–ü –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –∑–∞–¥–∞—á –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∞—É–¥–∏–æ. –ü–µ—Ä–µ–π–¥–µ–º –∫ —É–≥–ª—É–±–ª–µ–Ω–∏—é —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ç–∞–ª–µ–π –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

### üß† –£–≥–ª—É–±–ª–µ–Ω–∏–µ –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–∏–≥–Ω–∞–ª–æ–≤

–í–∞—à –≤—ã–±–æ—Ä **STM32F407** –∏ –≤–Ω–µ—à–Ω–µ–≥–æ –∫–æ–¥–µ–∫–∞ ‚Äî –æ–ø—Ç–∏–º–∞–ª–µ–Ω –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏. –î–∞–≤–∞–π—Ç–µ —É—Ç–æ—á–Ω–∏–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ "—É–∑–∫–∏–µ –º–µ—Å—Ç–∞".

#### 1. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å –¥–∞–Ω–Ω—ã—Ö –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

–î–ª—è `Fs = 48 –∫–ì—Ü` –∏ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–ª–æ–≤–∏–Ω–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞ `N = 128`:
*   –ü–µ—Ä–∏–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏: `T_processing = N / Fs = 128 / 48000 ‚âà 2.67 –º—Å`.
*   –ó–∞ —ç—Ç–æ –≤—Ä–µ–º—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ: —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –≤—ã—á–∏—Å–ª–∏—Ç—å RMS, –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –∫–æ–º–ø—Ä–µ—Å—Å–∏–∏ (—Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏) –∫–æ –≤—Å–µ–º `N` –æ—Ç—Å—á–µ—Ç–∞–º.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–≤–∞ –±—É—Ñ–µ—Ä–∞ –¥–ª—è –ê–¶–ü –∏ –¥–≤–∞ –¥–ª—è –¶–ê–ü (Double Buffering). –ü–æ–∫–∞ DMA –∑–∞–ø–æ–ª–Ω—è–µ—Ç –æ–¥–∏–Ω –±—É—Ñ–µ—Ä –ê–¶–ü, –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥—Ä—É–≥–æ–π. –≠—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç race condition –∏ –¥–∞–µ—Ç –ø–æ–ª–Ω—ã–µ `2.67 –º—Å` –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É.

```c
// –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤–æ–π–Ω–æ–π –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–µ–π
typedef struct {
    int16_t buffer[2][BUFFER_SIZE]; // buffer[0] –∏ buffer[1]
    volatile uint8_t dma_target;    // –ò–Ω–¥–µ–∫—Å –±—É—Ñ–µ—Ä–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –ø–∏—à–µ—Ç DMA (0 –∏–ª–∏ 1)
    volatile uint8_t proc_source;   // –ò–Ω–¥–µ–∫—Å –±—É—Ñ–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –≥–æ—Ç–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
} audio_buffer_t;

volatile audio_buffer_t adc_buf, dac_buf;
```

#### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è RMS –∏ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

–ü—Ä—è–º–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ `sqrtf(sum / len)` –Ω–∞ –∫–∞–∂–¥–æ–º –±–ª–æ–∫–µ —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–æ. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:

*   **–ê–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è RMS:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∏–∫–æ–≤–æ–µ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –±—ã—Å—Ç—Ä–æ–π –∞—Ç–∞–∫–æ–π –∏ –º–µ–¥–ª–µ–Ω–Ω—ã–º –∑–∞—Ç—É—Ö–∞–Ω–∏–µ–º –∫–∞–∫ –±–æ–ª–µ–µ –¥–µ—à–µ–≤—É—é –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —É—Ä–æ–≤–Ω—è.
*   **–¢–∞–±–ª–∏—Ü—ã –ø–æ–∏—Å–∫–∞ (LUT):** –î–ª—è –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (dB->–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç, –∫–æ—Ä–µ–Ω—å) –ø—Ä–µ–¥—Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —É—Å–∫–æ—Ä—è—é—Ç —Ä–∞–±–æ—Ç—É –≤ —Å–æ—Ç–Ω–∏ —Ä–∞–∑.

```c
// –ü—Ä–∏–º–µ—Ä LUT –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ª–∏–Ω–µ–π–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è (0..32767) –≤ dBFS
#define LUT_SIZE 32768
const float lin_to_dB_lut[LUT_SIZE];
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
for(int i=0; i<LUT_SIZE; i++) {
    lin_to_dB_lut[i] = 20.0f * log10f((float)i / 32767.0f);
}
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–±—ã—Å—Ç—Ä–æ)
float level = (float)abs(sample);
int index = (int)(level); // –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ
float dB = lin_to_dB_lut[index];
```

#### 3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π

–ê–ª–≥–æ—Ä–∏—Ç–º –≤ `process_audio_block()` —Ç—Ä–µ–±—É–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è (stateful) –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∞—Ç–∞–∫–∏/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.

```c
typedef struct {
    float threshold_dB;   // –ü–æ—Ä–æ–≥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä -24.0f dBFS
    float ratio;          // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ–º–ø—Ä–µ—Å—Å–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä 4.0f (4:1)
    float attack_ms;      // –í—Ä–µ–º—è –∞—Ç–∞–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä 5.0f –º—Å
    float release_ms;     // –í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä 50.0f –º—Å
    float gain_state;     // –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —É—Å–∏–ª–µ–Ω–∏—è (–ª–∏–Ω–µ–π–Ω–æ–µ)
} compressor_params_t;

void process_block_compressor(const int16_t *in, int16_t *out, uint16_t len, compressor_params_t *params) {
    // 1. –û—Ü–µ–Ω–∫–∞ —É—Ä–æ–≤–Ω—è –±–ª–æ–∫–∞ (RMS –∏–ª–∏ –ø–∏–∫–æ–≤—ã–π –¥–µ—Ç–µ–∫—Ç–æ—Ä)
    float block_level_dB = compute_block_level_dB(in, len);

    // 2. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —É—Å–∏–ª–µ–Ω–∏—è –ø–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–µ
    float target_gain_dB = compute_gain_dB(block_level_dB, params->threshold_dB, params->ratio);
    float target_gain_linear = powf(10.0f, target_gain_dB / 20.0f);

    // 3. –ü–ª–∞–≤–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Å —É—á–µ—Ç–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∞—Ç–∞–∫–∏/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
    // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤—Ä–µ–º–µ–Ω–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    // alpha_attack = expf(-1.0f / (params->attack_ms * 0.001f * Fs));
    // alpha_release = expf(-1.0f / (params->release_ms * 0.001f * Fs));
    float alpha = (target_gain_linear < params->gain_state) ? alpha_attack : alpha_release;
    params->gain_state = alpha * params->gain_state + (1.0f - alpha) * target_gain_linear;

    // 4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –∫ –∫–∞–∂–¥–æ–º—É –æ—Ç—Å—á–µ—Ç—É
    for(uint16_t i = 0; i < len; i++) {
        float sample_f = (float)in[i];
        sample_f *= params->gain_state;
        // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ (–∫–ª–∏–ø–ø–∏–Ω–≥)
        if(sample_f > 32767.0f) sample_f = 32767.0f;
        if(sample_f < -32768.0f) sample_f = -32768.0f;
        out[i] = (int16_t)sample_f;
    }
}
```

### ‚öôÔ∏è –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —à–∞–≥–∏ –ø–æ –æ—Ç–ª–∞–¥–∫–µ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏—é

1.  **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫:**
    *   –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **SEGGER SystemView** –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `process_block_compressor()`. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∏–∫–æ–≤–æ–µ –≤—Ä–µ–º—è –º–µ–Ω—å—à–µ `T_processing`.
    *   –í—ã–≤–µ–¥–∏—Ç–µ —Å–≤–æ–±–æ–¥–Ω—ã–π GPIO-–ø–∏–Ω –≤ `1` –Ω–∞ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –≤ `0` –≤ —Ä–µ–∂–∏–º–µ –æ–∂–∏–¥–∞–Ω–∏—è. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –æ—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.

2.  **–ò–∑–º–µ—Ä–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
    *   –î–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∞—Ç–∞–∫–∏/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π —Å–∏–≥–Ω–∞–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ Audacity) –∏ –ø–æ–¥–∞–π—Ç–µ –Ω–∞ –≤—Ö–æ–¥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –ó–∞–ø–∏—à–∏—Ç–µ –≤—ã—Ö–æ–¥ –Ω–∞ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä. –ü–æ –Ω–∞–∫–ª–æ–Ω—É –æ–≥–∏–±–∞—é—â–µ–π –≤—ã—á–∏—Å–ª–∏—Ç–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∏.
    *   –î–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (Input vs. Output) –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–¥–ª–µ–Ω–Ω—ã–π –ª–∏–Ω–µ–π–Ω–æ –Ω–∞—Ä–∞—Å—Ç–∞—é—â–∏–π —Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª (sweep).

3.  **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ Cortex-M4:**
    *   –í–∫–ª—é—á–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ `-mfpu=fpv4-sp-d16 -mfloat-abi=hard`.
    *   –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ CMSIS-DSP –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–¥ –º–∞—Å—Å–∏–≤–∞–º–∏ (`arm_*_f32`), –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç SIMD-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.
    *   –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∫ –≤—Ä–µ–º–µ–Ω–∏ —Ü–∏–∫–ª–æ–≤ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∞—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã—Ö –≤—Å—Ç–∞–≤–æ–∫ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ intrinsic-—Ñ—É–Ω–∫—Ü–∏–π.

**–°–ª–µ–¥—É—é—â–∏–π –ª–æ–≥–∏—á–µ—Å–∫–∏–π —ç—Ç–∞–ø:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞ (–ø–æ—Ä–æ–≥, —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ, –≤—Ä–µ–º—è) —á–µ—Ä–µ–∑ **UART/USB-CDC** –∏–ª–∏ **—ç–Ω–∫–æ–¥–µ—Ä —Å –¥–∏—Å–ø–ª–µ–µ–º**. –≠—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –æ–±–º–µ–Ω–∞ –∏, –≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ—Å—Ç–æ–≥–æ –º–µ–Ω—é.